# WS-78 Evidence (2026-02-27)

WS-78 turns the Python soak harness into a repeatable production gate for the native Wazuh lane.

## Reduced Gate Command

Command used for both reduced gate runs:

```bash
scripts/soak_runner.sh \
  --duration-hours 1 \
  --max-cycles 1 \
  --stage-timeout-seconds 1800 \
  --integration-runs 1 \
  --snapshot-runs 1 \
  --synth-count 1 \
  --fuzz-count 1 \
  --adversary-runs 0 \
  --siem-wazuh-runs 1 \
  --matrix-runs 0 \
  --label ws78-gate
```

Observed passing runs:

- `/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a`
- `/var/tmp/foxclaw-soak/20260227T165100Z-ws78-gate-b`

## PASS Output

Observed stage excerpt from the first reduced gate run:

```text
PASS cycle=1 stage=integration iter=1 ec=0 sec=2 log=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/logs/cycle-1-integration-1.log artifact=-
PASS cycle=1 stage=snapshot iter=1 ec=2 sec=1 log=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/logs/cycle-1-snapshot-1.log artifact=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/snapshots/cycle-1/snapshot-1.json
PASS cycle=1 stage=trust_scan iter=1 ec=0 sec=2 log=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/logs/cycle-1-trust-scan.log artifact=-
PASS cycle=1 stage=synth iter=1 ec=0 sec=1 log=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/logs/cycle-1-synth.log artifact=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/synth/cycle-1
PASS cycle=1 stage=fuzz iter=1 ec=0 sec=1 log=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/logs/cycle-1-fuzz.log artifact=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/fuzz/cycle-1
PASS cycle=1 stage=siem_wazuh iter=1 ec=0 sec=15 log=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/logs/cycle-1-siem-wazuh-1.log artifact=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/siem-wazuh/cycle-1-run-1
```

Observed summary:

```text
overall_status=PASS
steps_total=7
steps_failed=0
soak_summary_json=/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a/soak-summary.json
```

## Produced Artifacts

Run root:

- `summary.txt`
- `results.tsv`
- `run.log`
- `soak-summary.json`

Native Wazuh lane:

- `siem-wazuh/cycle-1-run-1/foxclaw.ndjson`
- `siem-wazuh/cycle-1-run-1/foxclaw-scan.log`
- `siem-wazuh/cycle-1-run-1/wazuh-logtest.txt`
- `siem-wazuh/cycle-1-run-1/alerts-excerpt.jsonl`
- `siem-wazuh/cycle-1-run-1/ossec-log-tail.txt`
- `siem-wazuh/cycle-1-run-1/manifest.json`

Observed `soak-summary.json` excerpt from the first run:

```json
{
  "artifact_root_path": "/var/tmp/foxclaw-soak/20260227T165031Z-ws78-gate-a",
  "git_sha": "46be00b85e470a83d8a105b8172d1bdb9884ff10",
  "ndjson_event_counts": {
    "foxclaw.finding": 4,
    "foxclaw.scan.summary": 1
  },
  "overall_status": "PASS",
  "stage_counts": {
    "siem_wazuh": {
      "fail": 0,
      "pass": 1
    }
  },
  "wazuh_image": "wazuh/wazuh-manager:4.14.3"
}
```

## Guardrails Added

- explicit Docker subprocess timeouts inside `scripts/siem_wazuh_smoke.py`
- bounded readiness, `wazuh-logtest`, and `alerts.json` retry loops using a single timeout budget
- failure artifact capture for:
  - `wazuh-logtest.txt`
  - `alerts-excerpt.jsonl`
  - `ossec-log-tail.txt`
  - `manifest.json`
- soak-stage timeout guard via `--stage-timeout-seconds`
- machine-readable `soak-summary.json` for each run
