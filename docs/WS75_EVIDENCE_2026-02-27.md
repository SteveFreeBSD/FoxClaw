# WS-75 Evidence (2026-02-27)

WS-75 closes the Python production-hardening gap by turning the Wazuh proof path into a native FoxClaw smoke runner and optional soak lane, then exercising it on `main`.

## 1. Native Wazuh Smoke Runner

Command used:

```bash
tmpdir="$(mktemp -d)"
.venv/bin/python scripts/siem_wazuh_smoke.py \
  --output-dir "${tmpdir}" \
  --python-bin .venv/bin/python
```

Observed result:

- exit code: `0`
- produced:
  - `foxclaw.ndjson`
  - `wazuh-logtest.txt`
  - `alerts-excerpt.jsonl`
  - `manifest.json`
- pinned image: `wazuh/wazuh-manager:4.14.3`

Observed `wazuh-logtest` excerpt:

```text
**Phase 2: Completed decoding.
    name: 'json'
    event_type: 'foxclaw.finding'
    rule_id: 'TB-POL-001'

**Phase 3: Completed filtering (rules).
    id: '100510'
    level: '8'
    description: 'FoxClaw finding event'
**Alert to be generated.
```

Observed `alerts.json` excerpt:

```json
{"rule":{"id":"100510","description":"FoxClaw finding event"},"data":{"event_type":"foxclaw.finding","rule_id":"TB-POL-001","severity":"INFO"},"location":"/var/log/foxclaw/foxclaw.ndjson"}
```

Interpretation:

- FoxClaw produced vendor-neutral NDJSON through the first-party CLI path.
- Wazuh decoded the NDJSON payload as JSON and matched the FoxClaw local rule.
- The live tailed file generated FoxClaw-specific alerts in `alerts.json`.

## 2. Reduced Soak with Native Wazuh Lane

Command used:

```bash
scripts/soak_runner.sh \
  --duration-hours 1 \
  --max-cycles 1 \
  --integration-runs 1 \
  --snapshot-runs 1 \
  --synth-count 1 \
  --fuzz-count 1 \
  --adversary-runs 0 \
  --siem-wazuh-runs 1 \
  --matrix-runs 0 \
  --label ws75-wazuh
```

Run summary:

- run dir: `/var/tmp/foxclaw-soak/20260227T161104Z-ws75-wazuh`
- `cycles_completed=1`
- `steps_total=7`
- `steps_passed=7`
- `steps_failed=0`
- `overall_status=PASS`

Observed stage excerpt:

```text
PASS cycle=1 stage=integration iter=1 sec=3
PASS cycle=1 stage=snapshot iter=1 sec=1 ec=2
PASS cycle=1 stage=snapshot_hash_check unique_hashes=1
PASS cycle=1 stage=trust_scan iter=1 sec=2
PASS cycle=1 stage=synth iter=1 sec=1
PASS cycle=1 stage=fuzz iter=1 sec=1
PASS cycle=1 stage=siem_wazuh iter=1 sec=14
```

Interpretation:

- The Wazuh lane now runs inside the normal soak harness instead of as a separate manual procedure.
- Existing soak lanes remained green with the new lane enabled.
- Python `main` now has production-oriented SIEM battle-test evidence, not just one-off NDJSON contract tests.

## 3. Operator Guardrails Captured

WS-75 also hardens the operator path by documenting and enforcing:

- one pinned Wazuh image (`wazuh/wazuh-manager:4.14.3`)
- fail-fast local image preflight before production testing
- bounded readiness waits around manager restart and `wazuh-logtest`
- deterministic artifact capture for NDJSON, rule-match proof, and live alert excerpts
