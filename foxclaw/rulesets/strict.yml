name: strict
version: 0.5.0
min_firefox_major: 120
rules:
  - id: FC-STRICT-PREF-001
    title: Telemetry upload preference must be explicitly set
    severity: HIGH
    category: preferences
    check:
      pref_exists:
        key: datareporting.healthreport.uploadEnabled
    rationale: Hardened baselines require explicit posture controls for telemetry behavior.
    recommendation: Set datareporting.healthreport.uploadEnabled in user.js.
    confidence: high

  - id: FC-STRICT-PREF-002
    title: Content blocking category must be strict
    severity: HIGH
    category: preferences
    check:
      pref_equals:
        key: browser.contentblocking.category
        value: strict
    rationale: Strict mode reduces tracking exposure in high-assurance environments.
    recommendation: Set browser.contentblocking.category to "strict".
    confidence: high

  - id: FC-STRICT-FILE-001
    title: key4.db must remain owner-only
    severity: HIGH
    category: filesystem
    check:
      file_perm_strict:
        key: key4
    rationale: Key material metadata requires restrictive filesystem permissions.
    recommendation: Restrict key4.db to mode 0600.
    confidence: high

  - id: FC-STRICT-FILE-002
    title: Cookies SQLite and sidecars must remain owner-only
    severity: HIGH
    category: filesystem
    check:
      file_perm_strict:
        path_glob: "*cookies.sqlite*"
    rationale: Cookie artifacts can expose sensitive session metadata if broadly readable.
    recommendation: Restrict cookies.sqlite and sidecars to mode 0600.
    confidence: high

  - id: FC-STRICT-POLICY-001
    title: Enterprise policy must explicitly disable telemetry
    severity: HIGH
    category: policy
    check:
      policy_key_exists:
        path: policies.DisableTelemetry
    rationale: Strict environments require explicit policy-level telemetry control.
    recommendation: Add DisableTelemetry under policies in policies.json.
    confidence: medium

  - id: FC-STRICT-POLICY-002
    title: Enterprise policy must disable Firefox Studies
    severity: HIGH
    category: policy
    check:
      policy_key_exists:
        path: policies.DisableFirefoxStudies
    rationale: Strict environments should disallow remote study enrollment paths.
    recommendation: Add DisableFirefoxStudies under policies in policies.json.
    confidence: high

  - id: FC-STRICT-POLICY-003
    title: Enterprise policy must define ExtensionSettings controls
    severity: HIGH
    category: policy
    check:
      policy_key_exists:
        path: policies.ExtensionSettings
    rationale: Strict environments require explicit extension allow/deny governance.
    recommendation: Add ExtensionSettings policy controls in policies.json.
    confidence: high

  - id: FC-STRICT-POLICY-004
    title: Enterprise policy must set HTTPS-only mode
    severity: HIGH
    category: policy
    check:
      policy_key_exists:
        path: policies.HTTPSOnlyMode
    rationale: Strict environments should enforce policy-controlled secure transport defaults.
    recommendation: Add HTTPSOnlyMode policy in policies.json.
    confidence: high

  - id: FC-STRICT-SQL-001
    title: places.sqlite quick_check must pass
    severity: HIGH
    category: sqlite
    check:
      sqlite_quickcheck_ok:
        db: places
    rationale: Database integrity failures invalidate confidence in collected evidence.
    recommendation: Repair or rebuild places.sqlite after preserving required data.
    confidence: high

  - id: FC-STRICT-SQL-002
    title: cookies.sqlite quick_check must pass
    severity: HIGH
    category: sqlite
    check:
      sqlite_quickcheck_ok:
        db: cookies
    rationale: Cookie database integrity is required for a reliable strict baseline signal.
    recommendation: Repair or rebuild cookies.sqlite after preserving required data.
    confidence: high

  - id: FC-STRICT-EXT-001
    title: Active extensions must be signed
    severity: HIGH
    category: extensions
    check:
      extension_unsigned_absent:
        include_system: false
    rationale: Strict baselines should not allow unsigned active extension code.
    recommendation: Remove unsigned extensions or replace with signed equivalents.
    confidence: high

  - id: FC-STRICT-EXT-002
    title: Active extensions must not expose medium/high-risk permissions
    severity: HIGH
    category: extensions
    check:
      extension_permission_risk_absent:
        min_level: medium
        include_system: false
    rationale: Strict environments require minimizing extension-level privilege exposure.
    recommendation: Remove or constrain extensions with elevated permission scopes.
    confidence: high

  - id: FC-STRICT-EXT-003
    title: Active extensions must not be blocklisted
    severity: HIGH
    category: extensions
    check:
      extension_blocklisted_absent:
        include_system: false
    rationale: Known malicious or heavily flawed extensions compromise the browser.
    recommendation: Remove blocklisted extensions immediately.
    confidence: high

  - id: FC-STRICT-EXT-004
    title: Active extensions must not be temporary debug installs
    severity: HIGH
    category: extensions
    check:
      extension_debug_absent:
        include_system: false
    rationale: Strict environments should disallow temporary debug extension loading paths.
    recommendation: Remove temporary installs and deploy signed production extension builds only.
    confidence: high

  - id: FC-STRICT-EXT-005
    title: Active extensions must not match medium/high extension intel reputation risk
    severity: HIGH
    category: extensions
    check:
      extension_intel_reputation_absent:
        min_level: medium
        include_unlisted: true
        include_system: false
    rationale: Strict baselines should block extensions with external intel risk or delisting signals.
    recommendation: Remove extensions flagged by extension intelligence risk metadata.
    confidence: high

  - id: FC-STRICT-CRED-001
    title: Saved logins must not include known vulnerable passwords
    severity: HIGH
    category: credentials
    check:
      credential_metric_max:
        metric: vulnerable_passwords_count
        max: 0
    rationale: Known vulnerable credentials represent active account takeover risk.
    recommendation: Rotate flagged credentials immediately and enforce unique passwords.
    confidence: high

  - id: FC-STRICT-CRED-002
    title: Saved logins must not target insecure HTTP origins
    severity: HIGH
    category: credentials
    check:
      credential_metric_max:
        metric: insecure_http_login_count
        max: 0
    rationale: Strict baselines disallow password persistence for cleartext HTTP targets.
    recommendation: Remove HTTP-origin saved credentials and migrate services to HTTPS.
    confidence: high

  - id: FC-STRICT-CRED-003
    title: Breach alert dismissals must be zero
    severity: HIGH
    category: credentials
    check:
      credential_metric_max:
        metric: dismissed_breach_alerts_count
        max: 0
    rationale: Dismissed leak alerts can mask unresolved exposure in strict environments.
    recommendation: Reopen and remediate dismissed breach alerts with verified rotations.
    confidence: high
